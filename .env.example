# Timezone used by containers.
TZ=Asia/Shanghai

# ===== Ports (host -> container) =====
# gpt-load host port (container listens on 3001).
GPTLOAD_PORT=3001
# LiteLLM host port (container listens on 4000).
LITELLM_PORT=4000
# SearXNG host port (container listens on 8080).
SEARXNG_PORT=8088
# Playwright MCP host port (maps to PLAYWRIGHT_MCP_PORT inside container).
PLAYWRIGHT_PORT=7070
# Optional: expose Postgres to host for debugging (container listens on 5432; compose defaults to NOT exposing).
POSTGRES_PORT=5439
# Optional: expose Valkey to host for debugging (container listens on 6379; compose defaults to NOT exposing).
VALKEY_PORT=6389

# ===== Postgres superuser (used by pg_init) =====
# Postgres admin username (avoid special chars; keep simple, e.g. postgres/admin).
POSTGRES_USER=postgres
# Postgres admin password.
# IMPORTANT: this password is also used inside DSNs like `postgresql://user:password@...`;
# use URL-safe characters (recommended: letters/digits + `-_`) or percent-encode reserved chars.
POSTGRES_PASSWORD=CHANGE_ME

# ===== Postgres performance (16C/48GB baseline; tune per workload) =====
# Max connections (increase if you see "too many clients").
POSTGRES_MAX_CONNECTIONS=900
# Shared buffers (e.g. 2GB/4GB). Keep within available RAM.
POSTGRES_SHARED_BUFFERS=8GB
# Effective cache size (planner hint, not a hard limit).
POSTGRES_EFFECTIVE_CACHE_SIZE=32GB
# Work mem per sort/hash (keep conservative to avoid OOM at high concurrency).
POSTGRES_WORK_MEM=4MB
# Maintenance work mem (vacuum/index build).
POSTGRES_MAINTENANCE_WORK_MEM=1GB
# WAL buffers.
POSTGRES_WAL_BUFFERS=16MB
# Min WAL size.
POSTGRES_MIN_WAL_SIZE=1GB
# Max WAL size.
POSTGRES_MAX_WAL_SIZE=4GB
# Checkpoint timeout.
POSTGRES_CHECKPOINT_TIMEOUT=15min
# Checkpoint completion target (0-1).
POSTGRES_CHECKPOINT_COMPLETION_TARGET=0.9
# Default statistics target.
POSTGRES_DEFAULT_STATISTICS_TARGET=100
# Random page cost (lower on SSD).
POSTGRES_RANDOM_PAGE_COST=1.1
# Effective IO concurrency (higher on SSD).
POSTGRES_EFFECTIVE_IO_CONCURRENCY=200
# WAL compression (on/off).
POSTGRES_WAL_COMPRESSION=on
# Shared preload libraries (commonly `pg_stat_statements`).
POSTGRES_SHARED_PRELOAD_LIBRARIES=pg_stat_statements
# pg_stat_statements.max (e.g. 10000).
POSTGRES_STAT_STATEMENTS_MAX=10000
# pg_stat_statements.track (top/all/none).
POSTGRES_STAT_STATEMENTS_TRACK=top
# Log slow queries in ms (0 disables; e.g. 200).
POSTGRES_LOG_MIN_DURATION_STATEMENT=200

# ===== App DBs created by pg_init =====
# gpt-load database name.
GPTLOAD_DB_NAME=gptload
# gpt-load database user (avoid special chars; keep simple).
GPTLOAD_DB_USER=gptload
# gpt-load database password (URL-safe or percent-encoded; see POSTGRES_PASSWORD note).
GPTLOAD_DB_PASSWORD=CHANGE_ME

# LiteLLM database name.
LITELLM_DB_NAME=litellm
# LiteLLM database user (avoid special chars; keep simple).
LITELLM_DB_USER=litellm
# LiteLLM database password (URL-safe or percent-encoded; see POSTGRES_PASSWORD note).
LITELLM_DB_PASSWORD=CHANGE_ME

# Firecrawl database name (required if Firecrawl enabled).
FIRECRAWL_DB_NAME=firecrawl
# Firecrawl database user (avoid special chars; keep simple).
FIRECRAWL_DB_USER=firecrawl
# Firecrawl database password (URL-safe or percent-encoded; used by Firecrawl DSNs).
FIRECRAWL_DB_PASSWORD=CHANGE_ME

# ===== Valkey (Redis-compatible) =====
# Valkey password.
# IMPORTANT: used inside redis URLs like `redis://:password@...`; use URL-safe characters or percent-encode.
VALKEY_PASSWORD=CHANGE_ME
# Max memory (e.g. 1gb/4gb).
VALKEY_MAXMEMORY=8gb
# Eviction policy (e.g. allkeys-lru / volatile-lru / noeviction).
VALKEY_MAXMEMORY_POLICY=allkeys-lru

# ===== gpt-load (admin + at-rest encryption) =====
# Admin login key for gpt-load.
# Recommended: 32+ chars random string; URL-safe characters (letters/digits + `-_`) to avoid DSN/header issues.
GPTLOAD_AUTH_KEY=CHANGE_ME
# Optional at-rest encryption key used by gpt-load.
# Follow gpt-load requirements; recommended: 32+ chars random string (URL-safe).
GPTLOAD_ENCRYPTION_KEY=CHANGE_ME

# ===== gpt-load performance =====
# Max concurrent requests handled by gpt-load.
GPTLOAD_MAX_CONCURRENT_REQUESTS=300

# ===== LiteLLM keys =====
# LiteLLM master key (used for API auth).
# Convention: use a `sk-` prefix for human recognition; keep URL-safe characters.
LITELLM_MASTER_KEY=sk-CHANGE_ME
# LiteLLM salt key (used for hashing; keep secret).
# Convention: use a `sk-` prefix; keep URL-safe characters.
LITELLM_SALT_KEY=sk-CHANGE_ME

# ===== SearXNG (meta-search) =====
# SearXNG instance secret (required).
# Recommended: 32+ chars random string; URL-safe characters.
SEARXNG_SECRET=CHANGE_ME
# Optional external base URL when running behind reverse proxy (trailing slash recommended).
SEARXNG_BASE_URL=http://localhost:8088/

# ===== Playwright (browser MCP server) =====
# Playwright MCP image (keep in sync with your Playwright stack).
PLAYWRIGHT_IMAGE=mcr.microsoft.com/playwright:v1.49.0-jammy
# Port inside Playwright container for MCP endpoint.
PLAYWRIGHT_MCP_PORT=7070
# Run browsers headless (true/false).
PLAYWRIGHT_HEADLESS=true
# Ignore HTTPS errors (true/false).
PLAYWRIGHT_IGNORE_HTTPS_ERRORS=true
# Block service workers (true/false).
PLAYWRIGHT_BLOCK_SERVICE_WORKERS=true
# Reuse a shared browser context across sessions (true/false).
PLAYWRIGHT_SHARED_BROWSER_CONTEXT=false
# Action timeout in ms (e.g. 15000).
PLAYWRIGHT_TIMEOUT_ACTION_MS=15000
# Navigation timeout in ms (e.g. 45000).
PLAYWRIGHT_TIMEOUT_NAVIGATION_MS=45000
# Snapshot mode (off/on).
PLAYWRIGHT_SNAPSHOT_MODE=off
# Save image responses (true/false).
PLAYWRIGHT_IMAGE_RESPONSES=false
# Allowed Host headers (set `*` to allow container-name access).
PLAYWRIGHT_ALLOWED_HOSTS=*
# Console log level (silent/error/warn/info/debug).
PLAYWRIGHT_CONSOLE_LEVEL=info
# Emulated device name (optional; empty disables).
PLAYWRIGHT_DEVICE=
# Viewport size as `width,height` (optional).
PLAYWRIGHT_VIEWPORT_SIZE=1280,720
# Custom user agent (optional).
PLAYWRIGHT_USER_AGENT=
# Outbound proxy URL for Playwright (optional; e.g. http://host:port).
PLAYWRIGHT_PROXY_SERVER=
# Proxy bypass list (optional).
PLAYWRIGHT_PROXY_BYPASS=
# Extra capability JSON (optional; keep valid JSON).
PLAYWRIGHT_CAPS=
# Output directory inside container (optional; mount if you want to persist).
PLAYWRIGHT_OUTPUT_DIR=/tmp/playwright
# Save session state (true/false).
PLAYWRIGHT_SAVE_SESSION=false
# Save traces (true/false).
PLAYWRIGHT_SAVE_TRACE=false
# Extra args appended to `playwright run-mcp-server` (optional).
PLAYWRIGHT_EXTRA_ARGS=

# ===== Firecrawl (web crawling + extraction) =====
# Firecrawl image tag (pin for reproducibility).
FIRECRAWL_IMAGE=ghcr.io/firecrawl/firecrawl:latest
# Firecrawl host port (container listens on 3002).
FIRECRAWL_PORT=3002
# Firecrawl Bull auth key (required).
# Recommended: 32+ chars random string; URL-safe characters.
FIRECRAWL_BULL_AUTH_KEY=CHANGE_ME
# RabbitMQ username for Firecrawl jobs.
FIRECRAWL_RABBITMQ_USER=firecrawl
# RabbitMQ password (also used in `amqp://user:password@...`; use URL-safe characters or percent-encode).
FIRECRAWL_RABBITMQ_PASSWORD=CHANGE_ME

# Firecrawl performance (shared 8c/32GB baseline; tune as needed)
# Workers per queue (increase for throughput).
FIRECRAWL_NUM_WORKERS_PER_QUEUE=4
# Crawl concurrent requests.
FIRECRAWL_CRAWL_CONCURRENT_REQUESTS=12
# Max concurrent jobs.
FIRECRAWL_MAX_CONCURRENT_JOBS=24
# Browser pool size.
FIRECRAWL_BROWSER_POOL_SIZE=3
# Container CPU limit (e.g. 4).
FIRECRAWL_MAX_CPU=6
# Container RAM limit (e.g. 8g).
FIRECRAWL_MAX_RAM=12g

# Firecrawl /search via SearXNG (use in-stack searxng)
# SearXNG endpoint for Firecrawl (in-stack default).
FIRECRAWL_SEARXNG_ENDPOINT=http://searxng:8080
# Allowed engines (comma-separated).
FIRECRAWL_SEARXNG_ENGINES=google,bing,duckduckgo
# Allowed categories (comma-separated).
FIRECRAWL_SEARXNG_CATEGORIES=general

# Firecrawl Playwright microservice (in-stack server.mjs)
# Host port for microservice (container listens on same value).
FIRECRAWL_PW_PORT=3000
# Browser to use (chromium/firefox/webkit).
FIRECRAWL_PW_BROWSER=chromium
# Headless mode (true/false).
FIRECRAWL_PW_HEADLESS=true
# Block media requests (true/false).
FIRECRAWL_PW_BLOCK_MEDIA=true
# Wait until (load/domcontentloaded/networkidle).
FIRECRAWL_PW_WAIT_UNTIL=domcontentloaded
# Max concurrent pages.
FIRECRAWL_PW_MAX_CONCURRENT_PAGES=6
# Navigation timeout in ms.
FIRECRAWL_PW_NAVIGATION_TIMEOUT_MS=45000
# Action timeout in ms.
FIRECRAWL_PW_ACTION_TIMEOUT_MS=15000

# Optional: route Firecrawl AI features to your OpenAI-compatible gateway
# OpenAI API key (optional; set empty to disable AI features).
FIRECRAWL_OPENAI_API_KEY=
# OpenAI base URL (optional; e.g. http://share_gptload:3001/proxy/openai/v1).
FIRECRAWL_OPENAI_BASE_URL=

# Optional: outbound proxy for Firecrawl (also used by firecrawl-playwright)
# Proxy server URL (optional; e.g. http://host:port).
FIRECRAWL_PROXY_SERVER=
# Proxy username (optional).
FIRECRAWL_PROXY_USERNAME=
# Proxy password (optional).
FIRECRAWL_PROXY_PASSWORD=
